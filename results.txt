Using TensorFlow backend.
Grand Epoch: 1 / 3
Segment: seg0
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 132us/step - loss: 0.4772 - acc: 0.8585 - val_loss: 0.2426 - val_acc: 0.9235
Epoch 2/2
12000/12000 [==============================] - 1s 117us/step - loss: 0.1948 - acc: 0.9426 - val_loss: 0.1789 - val_acc: 0.9449
Segment: seg1
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 137us/step - loss: 0.5012 - acc: 0.8519 - val_loss: 0.2044 - val_acc: 0.9402
Epoch 2/2
12000/12000 [==============================] - 1s 112us/step - loss: 0.1933 - acc: 0.9423 - val_loss: 0.1722 - val_acc: 0.9460
Segment: seg2
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 137us/step - loss: 0.4898 - acc: 0.8552 - val_loss: 0.2279 - val_acc: 0.9308
Epoch 2/2
12000/12000 [==============================] - 1s 119us/step - loss: 0.1988 - acc: 0.9412 - val_loss: 0.1655 - val_acc: 0.9508
Segment: seg3
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 141us/step - loss: 0.5138 - acc: 0.8486 - val_loss: 0.2441 - val_acc: 0.9287
Epoch 2/2
12000/12000 [==============================] - 1s 114us/step - loss: 0.2111 - acc: 0.9352 - val_loss: 0.1964 - val_acc: 0.9410
Segment: seg4
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 142us/step - loss: 0.4736 - acc: 0.8587 - val_loss: 0.2269 - val_acc: 0.9328
Epoch 2/2
12000/12000 [==============================] - 1s 113us/step - loss: 0.1783 - acc: 0.9464 - val_loss: 0.1689 - val_acc: 0.9477
10000/10000 [==============================] - 1s 67us/step
['2.922237396621704', '0.8165']
Grand Epoch: 2 / 3
Segment: seg0
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 154us/step - loss: 0.4771 - acc: 0.8622 - val_loss: 0.2450 - val_acc: 0.9283
Epoch 2/2
12000/12000 [==============================] - 1s 116us/step - loss: 0.1921 - acc: 0.9438 - val_loss: 0.1796 - val_acc: 0.9442
Segment: seg1
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 149us/step - loss: 0.5104 - acc: 0.8455 - val_loss: 0.2114 - val_acc: 0.9365
Epoch 2/2
12000/12000 [==============================] - 1s 114us/step - loss: 0.1963 - acc: 0.9403 - val_loss: 0.1621 - val_acc: 0.9482
Segment: seg2
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 156us/step - loss: 0.4950 - acc: 0.8541 - val_loss: 0.2220 - val_acc: 0.9323
Epoch 2/2
12000/12000 [==============================] - 1s 110us/step - loss: 0.1933 - acc: 0.9391 - val_loss: 0.1572 - val_acc: 0.9526
Segment: seg3
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 155us/step - loss: 0.5104 - acc: 0.8454 - val_loss: 0.2440 - val_acc: 0.9267
Epoch 2/2
12000/12000 [==============================] - 1s 119us/step - loss: 0.2062 - acc: 0.9378 - val_loss: 0.1761 - val_acc: 0.9482
Segment: seg4
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 173us/step - loss: 0.4619 - acc: 0.8623 - val_loss: 0.2366 - val_acc: 0.9287
Epoch 2/2
12000/12000 [==============================] - 1s 114us/step - loss: 0.1807 - acc: 0.9472 - val_loss: 0.1635 - val_acc: 0.9496
10000/10000 [==============================] - 1s 92us/step
['0.8928478422234981', '0.943']
Grand Epoch: 3 / 3
Segment: seg0
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 168us/step - loss: 0.4822 - acc: 0.8567 - val_loss: 0.2276 - val_acc: 0.9312
Epoch 2/2
12000/12000 [==============================] - 1s 119us/step - loss: 0.1855 - acc: 0.9456 - val_loss: 0.2189 - val_acc: 0.9311
Segment: seg1
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 190us/step - loss: 0.5008 - acc: 0.8523 - val_loss: 0.2310 - val_acc: 0.9287
Epoch 2/2
12000/12000 [==============================] - 2s 126us/step - loss: 0.1978 - acc: 0.9404 - val_loss: 0.1549 - val_acc: 0.9493
Segment: seg2
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 171us/step - loss: 0.4884 - acc: 0.8512 - val_loss: 0.2112 - val_acc: 0.9366
Epoch 2/2
12000/12000 [==============================] - 2s 130us/step - loss: 0.1885 - acc: 0.9428 - val_loss: 0.1557 - val_acc: 0.9527
Segment: seg3
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 170us/step - loss: 0.5023 - acc: 0.8494 - val_loss: 0.2314 - val_acc: 0.9316
Epoch 2/2
12000/12000 [==============================] - 2s 134us/step - loss: 0.2046 - acc: 0.9362 - val_loss: 0.1707 - val_acc: 0.9465
Segment: seg4
Train on 12000 samples, validate on 10000 samples
Epoch 1/2
12000/12000 [==============================] - 2s 173us/step - loss: 0.4735 - acc: 0.8570 - val_loss: 0.2259 - val_acc: 0.9324
Epoch 2/2
12000/12000 [==============================] - 2s 131us/step - loss: 0.1849 - acc: 0.9431 - val_loss: 0.1658 - val_acc: 0.9489
10000/10000 [==============================] - 1s 90us/step
['2.90473474887684', '0.8161']
60000/60000 [==============================] - 3s 50us/step
10000/10000 [==============================] - 1s 51us/step
Training accuracy with merged model: 0.81975
Test accuracy with merged model: 0.8161
Training accuracy with ensembling and consensus predictors: 0.958183333333
Test accuracy with ensembling and consensus predictors: 0.9573

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Using TensorFlow backend.
Grand Epoch: 1 / 3
Segment: seg0
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 142us/step - loss: 0.4729 - acc: 0.8631 - val_loss: 0.2208 - val_acc: 0.9335
Epoch 2/4
12000/12000 [==============================] - 1s 113us/step - loss: 0.1826 - acc: 0.9447 - val_loss: 0.2190 - val_acc: 0.9324
Epoch 3/4
12000/12000 [==============================] - 1s 113us/step - loss: 0.1202 - acc: 0.9655 - val_loss: 0.1440 - val_acc: 0.9548
Epoch 4/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.0825 - acc: 0.9754 - val_loss: 0.1440 - val_acc: 0.9557
Segment: seg1
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 136us/step - loss: 0.4994 - acc: 0.8485 - val_loss: 0.2155 - val_acc: 0.9366
Epoch 2/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1980 - acc: 0.9409 - val_loss: 0.1592 - val_acc: 0.9517
Epoch 3/4
12000/12000 [==============================] - 1s 113us/step - loss: 0.1241 - acc: 0.9635 - val_loss: 0.1423 - val_acc: 0.9533
Epoch 4/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.0830 - acc: 0.9748 - val_loss: 0.1285 - val_acc: 0.9618
Segment: seg2
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 137us/step - loss: 0.5112 - acc: 0.8463 - val_loss: 0.2303 - val_acc: 0.9312
Epoch 2/4
12000/12000 [==============================] - 1s 109us/step - loss: 0.1938 - acc: 0.9396 - val_loss: 0.1701 - val_acc: 0.9480
Epoch 3/4
12000/12000 [==============================] - 1s 111us/step - loss: 0.1246 - acc: 0.9611 - val_loss: 0.1486 - val_acc: 0.9540
Epoch 4/4
12000/12000 [==============================] - 1s 118us/step - loss: 0.0904 - acc: 0.9721 - val_loss: 0.1365 - val_acc: 0.9582
Segment: seg3
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 165us/step - loss: 0.5096 - acc: 0.8437 - val_loss: 0.2147 - val_acc: 0.9364
Epoch 2/4
12000/12000 [==============================] - 2s 136us/step - loss: 0.2036 - acc: 0.9384 - val_loss: 0.1722 - val_acc: 0.9462
Epoch 3/4
12000/12000 [==============================] - 1s 121us/step - loss: 0.1366 - acc: 0.9588 - val_loss: 0.1628 - val_acc: 0.9479
Epoch 4/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.0955 - acc: 0.9695 - val_loss: 0.1363 - val_acc: 0.9573
Segment: seg4
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 141us/step - loss: 0.4821 - acc: 0.8566 - val_loss: 0.2436 - val_acc: 0.9253
Epoch 2/4
12000/12000 [==============================] - 1s 118us/step - loss: 0.1857 - acc: 0.9416 - val_loss: 0.1646 - val_acc: 0.9484
Epoch 3/4
12000/12000 [==============================] - 1s 112us/step - loss: 0.1244 - acc: 0.9616 - val_loss: 0.1526 - val_acc: 0.9534
Epoch 4/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.0812 - acc: 0.9748 - val_loss: 0.1467 - val_acc: 0.9553
10000/10000 [==============================] - 1s 69us/step
['0.6303978017542511', '0.8701']
Grand Epoch: 2 / 3
Segment: seg0
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 154us/step - loss: 0.4828 - acc: 0.8597 - val_loss: 0.2347 - val_acc: 0.9320
Epoch 2/4
12000/12000 [==============================] - 1s 113us/step - loss: 0.1873 - acc: 0.9449 - val_loss: 0.1641 - val_acc: 0.9489
Epoch 3/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1231 - acc: 0.9649 - val_loss: 0.1467 - val_acc: 0.9550
Epoch 4/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.0878 - acc: 0.9749 - val_loss: 0.1538 - val_acc: 0.9529
Segment: seg1
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 149us/step - loss: 0.5187 - acc: 0.8414 - val_loss: 0.2239 - val_acc: 0.9294
Epoch 2/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.1950 - acc: 0.9413 - val_loss: 0.1816 - val_acc: 0.9396
Epoch 3/4
12000/12000 [==============================] - 1s 113us/step - loss: 0.1267 - acc: 0.9621 - val_loss: 0.1448 - val_acc: 0.9549
Epoch 4/4
12000/12000 [==============================] - 1s 114us/step - loss: 0.0868 - acc: 0.9736 - val_loss: 0.1231 - val_acc: 0.9619
Segment: seg2
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 152us/step - loss: 0.4882 - acc: 0.8534 - val_loss: 0.2250 - val_acc: 0.9318
Epoch 2/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1933 - acc: 0.9415 - val_loss: 0.1779 - val_acc: 0.9476
Epoch 3/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1262 - acc: 0.9609 - val_loss: 0.1315 - val_acc: 0.9610
Epoch 4/4
12000/12000 [==============================] - 1s 118us/step - loss: 0.0851 - acc: 0.9752 - val_loss: 0.1337 - val_acc: 0.9582
Segment: seg3
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 157us/step - loss: 0.4940 - acc: 0.8551 - val_loss: 0.2336 - val_acc: 0.9268
Epoch 2/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.2063 - acc: 0.9368 - val_loss: 0.1779 - val_acc: 0.9453
Epoch 3/4
12000/12000 [==============================] - 1s 118us/step - loss: 0.1346 - acc: 0.9602 - val_loss: 0.1406 - val_acc: 0.9551
Epoch 4/4
12000/12000 [==============================] - 1s 112us/step - loss: 0.0940 - acc: 0.9721 - val_loss: 0.1550 - val_acc: 0.9527
Segment: seg4
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 157us/step - loss: 0.4808 - acc: 0.8543 - val_loss: 0.2381 - val_acc: 0.9273
Epoch 2/4
12000/12000 [==============================] - 1s 120us/step - loss: 0.1885 - acc: 0.9435 - val_loss: 0.1661 - val_acc: 0.9477
Epoch 3/4
12000/12000 [==============================] - 1s 105us/step - loss: 0.1191 - acc: 0.9626 - val_loss: 0.1535 - val_acc: 0.9530
Epoch 4/4
12000/12000 [==============================] - 1s 105us/step - loss: 0.0861 - acc: 0.9728 - val_loss: 0.1314 - val_acc: 0.9601
10000/10000 [==============================] - 1s 72us/step
['1.119078735923767', '0.9289']
Grand Epoch: 3 / 3
Segment: seg0
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 169us/step - loss: 0.4874 - acc: 0.8518 - val_loss: 0.2247 - val_acc: 0.9320
Epoch 2/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1824 - acc: 0.9459 - val_loss: 0.1709 - val_acc: 0.9487
Epoch 3/4
12000/12000 [==============================] - 1s 117us/step - loss: 0.1209 - acc: 0.9638 - val_loss: 0.1375 - val_acc: 0.9548
Epoch 4/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.0844 - acc: 0.9730 - val_loss: 0.1534 - val_acc: 0.9529
Segment: seg1
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 164us/step - loss: 0.5138 - acc: 0.8448 - val_loss: 0.2379 - val_acc: 0.9271
Epoch 2/4
12000/12000 [==============================] - 1s 118us/step - loss: 0.1913 - acc: 0.9426 - val_loss: 0.1535 - val_acc: 0.9514
Epoch 3/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1228 - acc: 0.9607 - val_loss: 0.1530 - val_acc: 0.9527
Epoch 4/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.0799 - acc: 0.9749 - val_loss: 0.1352 - val_acc: 0.9591
Segment: seg2
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 167us/step - loss: 0.4975 - acc: 0.8483 - val_loss: 0.2353 - val_acc: 0.9301
Epoch 2/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.1944 - acc: 0.9420 - val_loss: 0.1549 - val_acc: 0.9545
Epoch 3/4
12000/12000 [==============================] - 1s 123us/step - loss: 0.1299 - acc: 0.9604 - val_loss: 0.1474 - val_acc: 0.9554
Epoch 4/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.0881 - acc: 0.9735 - val_loss: 0.1179 - val_acc: 0.9628
Segment: seg3
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 170us/step - loss: 0.5109 - acc: 0.8448 - val_loss: 0.2205 - val_acc: 0.9334
Epoch 2/4
12000/12000 [==============================] - 1s 117us/step - loss: 0.2073 - acc: 0.9389 - val_loss: 0.2013 - val_acc: 0.9395
Epoch 3/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.1362 - acc: 0.9569 - val_loss: 0.1451 - val_acc: 0.9564
Epoch 4/4
12000/12000 [==============================] - 1s 120us/step - loss: 0.0961 - acc: 0.9698 - val_loss: 0.1473 - val_acc: 0.9562
Segment: seg4
Train on 12000 samples, validate on 10000 samples
Epoch 1/4
12000/12000 [==============================] - 2s 170us/step - loss: 0.4726 - acc: 0.8578 - val_loss: 0.2213 - val_acc: 0.9333
Epoch 2/4
12000/12000 [==============================] - 1s 116us/step - loss: 0.1838 - acc: 0.9453 - val_loss: 0.1899 - val_acc: 0.9401
Epoch 3/4
12000/12000 [==============================] - 1s 118us/step - loss: 0.1189 - acc: 0.9639 - val_loss: 0.1544 - val_acc: 0.9521
Epoch 4/4
12000/12000 [==============================] - 1s 115us/step - loss: 0.0836 - acc: 0.9725 - val_loss: 0.1474 - val_acc: 0.9557
10000/10000 [==============================] - 1s 90us/step
['2.4516832767636174', '0.847']
60000/60000 [==============================] - 3s 44us/step
10000/10000 [==============================] - 0s 49us/step
Training accuracy with merged model: 0.8440166666666666
Test accuracy with merged model: 0.847
Training accuracy with ensembling and consensus predictors: 0.97095
Test accuracy with ensembling and consensus predictors: 0.9673

  asridhar in ~/Desktop/distributed_neural_network
±  |master U:1 ?:3 ✗| → python distributed_model_training.py
dyld: warning, LC_RPATH $ORIGIN/../../_solib_darwin_x86_64/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow in /Library/Python/2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so being ignored in restricted program because it is a relative path
/Library/Python/2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Grand Epoch: 1 / 3
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 211us/step - loss: 0.6549 - acc: 0.8040 - val_loss: 0.3099 - val_acc: 0.9071
Epoch 2/4
6000/6000 [==============================] - 1s 132us/step - loss: 0.2471 - acc: 0.9272 - val_loss: 0.2828 - val_acc: 0.9131
Epoch 3/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.1633 - acc: 0.9520 - val_loss: 0.2223 - val_acc: 0.9330
Epoch 4/4
6000/6000 [==============================] - 1s 128us/step - loss: 0.1087 - acc: 0.9692 - val_loss: 0.2029 - val_acc: 0.9367
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 177us/step - loss: 0.6935 - acc: 0.7893 - val_loss: 0.3189 - val_acc: 0.9042
Epoch 2/4
6000/6000 [==============================] - 1s 133us/step - loss: 0.2596 - acc: 0.9252 - val_loss: 0.2564 - val_acc: 0.9242
Epoch 3/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.1827 - acc: 0.9453 - val_loss: 0.2200 - val_acc: 0.9331
Epoch 4/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.1237 - acc: 0.9647 - val_loss: 0.2013 - val_acc: 0.9413
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 181us/step - loss: 0.6961 - acc: 0.7927 - val_loss: 0.3194 - val_acc: 0.9083
Epoch 2/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.2674 - acc: 0.9210 - val_loss: 0.2190 - val_acc: 0.9351
Epoch 3/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1803 - acc: 0.9435 - val_loss: 0.1745 - val_acc: 0.9472
Epoch 4/4
6000/6000 [==============================] - 1s 128us/step - loss: 0.1222 - acc: 0.9638 - val_loss: 0.1579 - val_acc: 0.9526
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 181us/step - loss: 0.6721 - acc: 0.7985 - val_loss: 0.2949 - val_acc: 0.9150
Epoch 2/4
6000/6000 [==============================] - 1s 135us/step - loss: 0.2466 - acc: 0.9272 - val_loss: 0.2315 - val_acc: 0.9306
Epoch 3/4
6000/6000 [==============================] - 1s 128us/step - loss: 0.1644 - acc: 0.9517 - val_loss: 0.2148 - val_acc: 0.9329
Epoch 4/4
6000/6000 [==============================] - 1s 126us/step - loss: 0.1079 - acc: 0.9687 - val_loss: 0.1901 - val_acc: 0.9404
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 191us/step - loss: 0.6709 - acc: 0.8008 - val_loss: 0.3028 - val_acc: 0.9116
Epoch 2/4
6000/6000 [==============================] - 1s 131us/step - loss: 0.2660 - acc: 0.9185 - val_loss: 0.2664 - val_acc: 0.9170
Epoch 3/4
6000/6000 [==============================] - 1s 131us/step - loss: 0.1735 - acc: 0.9465 - val_loss: 0.2141 - val_acc: 0.9342
Epoch 4/4
6000/6000 [==============================] - 1s 131us/step - loss: 0.1171 - acc: 0.9678 - val_loss: 0.1922 - val_acc: 0.9419
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 193us/step - loss: 0.7191 - acc: 0.7812 - val_loss: 0.2930 - val_acc: 0.9134
Epoch 2/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.2562 - acc: 0.9198 - val_loss: 0.2119 - val_acc: 0.9356
Epoch 3/4
6000/6000 [==============================] - 1s 130us/step - loss: 0.1678 - acc: 0.9493 - val_loss: 0.2123 - val_acc: 0.9336
Epoch 4/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.1163 - acc: 0.9642 - val_loss: 0.1728 - val_acc: 0.9483
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 195us/step - loss: 0.6840 - acc: 0.7960 - val_loss: 0.3236 - val_acc: 0.9056
Epoch 2/4
6000/6000 [==============================] - 1s 132us/step - loss: 0.2568 - acc: 0.9202 - val_loss: 0.2638 - val_acc: 0.9198
Epoch 3/4
6000/6000 [==============================] - 1s 128us/step - loss: 0.1752 - acc: 0.9487 - val_loss: 0.1954 - val_acc: 0.9410
Epoch 4/4
6000/6000 [==============================] - 1s 133us/step - loss: 0.1233 - acc: 0.9642 - val_loss: 0.1869 - val_acc: 0.9442
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 200us/step - loss: 0.6967 - acc: 0.7865 - val_loss: 0.3154 - val_acc: 0.9053
Epoch 2/4
6000/6000 [==============================] - 1s 131us/step - loss: 0.2674 - acc: 0.9177 - val_loss: 0.2382 - val_acc: 0.9290
Epoch 3/4
6000/6000 [==============================] - 1s 132us/step - loss: 0.1760 - acc: 0.9470 - val_loss: 0.2125 - val_acc: 0.9366
Epoch 4/4
6000/6000 [==============================] - 1s 144us/step - loss: 0.1241 - acc: 0.9607 - val_loss: 0.1798 - val_acc: 0.9479
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 207us/step - loss: 0.6834 - acc: 0.7997 - val_loss: 0.2951 - val_acc: 0.9102
Epoch 2/4
6000/6000 [==============================] - 1s 136us/step - loss: 0.2676 - acc: 0.9195 - val_loss: 0.2405 - val_acc: 0.9263
Epoch 3/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.1793 - acc: 0.9463 - val_loss: 0.1960 - val_acc: 0.9387
Epoch 4/4
6000/6000 [==============================] - 1s 133us/step - loss: 0.1256 - acc: 0.9613 - val_loss: 0.1885 - val_acc: 0.9404
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 219us/step - loss: 0.6271 - acc: 0.8128 - val_loss: 0.3252 - val_acc: 0.9062
Epoch 2/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.2080 - acc: 0.9353 - val_loss: 0.2476 - val_acc: 0.9268
Epoch 3/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1354 - acc: 0.9607 - val_loss: 0.2304 - val_acc: 0.9307
Epoch 4/4
6000/6000 [==============================] - 1s 138us/step - loss: 0.0927 - acc: 0.9718 - val_loss: 0.2098 - val_acc: 0.9381
10000/10000 [==============================] - 1s 69us/step
['11.261644581604005', '0.2972']
Grand Epoch: 2 / 3
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 251us/step - loss: 0.6614 - acc: 0.8038 - val_loss: 0.2921 - val_acc: 0.9142
Epoch 2/4
6000/6000 [==============================] - 1s 133us/step - loss: 0.2441 - acc: 0.9297 - val_loss: 0.2288 - val_acc: 0.9301
Epoch 3/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.1569 - acc: 0.9552 - val_loss: 0.2144 - val_acc: 0.9327
Epoch 4/4
6000/6000 [==============================] - 1s 137us/step - loss: 0.1089 - acc: 0.9672 - val_loss: 0.1948 - val_acc: 0.9396
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 228us/step - loss: 0.6890 - acc: 0.7967 - val_loss: 0.3119 - val_acc: 0.9103
Epoch 2/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.2607 - acc: 0.9227 - val_loss: 0.2446 - val_acc: 0.9238
Epoch 3/4
6000/6000 [==============================] - 1s 128us/step - loss: 0.1745 - acc: 0.9467 - val_loss: 0.2197 - val_acc: 0.9334
Epoch 4/4
6000/6000 [==============================] - 1s 137us/step - loss: 0.1172 - acc: 0.9628 - val_loss: 0.1983 - val_acc: 0.9408
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 247us/step - loss: 0.7319 - acc: 0.7808 - val_loss: 0.2942 - val_acc: 0.9139
Epoch 2/4
6000/6000 [==============================] - 1s 130us/step - loss: 0.2757 - acc: 0.9147 - val_loss: 0.2165 - val_acc: 0.9342
Epoch 3/4
6000/6000 [==============================] - 1s 137us/step - loss: 0.1749 - acc: 0.9465 - val_loss: 0.1946 - val_acc: 0.9401
Epoch 4/4
6000/6000 [==============================] - 1s 159us/step - loss: 0.1292 - acc: 0.9598 - val_loss: 0.1657 - val_acc: 0.9491
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 245us/step - loss: 0.6537 - acc: 0.8045 - val_loss: 0.3288 - val_acc: 0.9036
Epoch 2/4
6000/6000 [==============================] - 1s 163us/step - loss: 0.2520 - acc: 0.9275 - val_loss: 0.2348 - val_acc: 0.9316
Epoch 3/4
6000/6000 [==============================] - 1s 145us/step - loss: 0.1649 - acc: 0.9497 - val_loss: 0.1965 - val_acc: 0.9405
Epoch 4/4
6000/6000 [==============================] - 1s 152us/step - loss: 0.1140 - acc: 0.9685 - val_loss: 0.1857 - val_acc: 0.9423
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 256us/step - loss: 0.6944 - acc: 0.7917 - val_loss: 0.3126 - val_acc: 0.9064
Epoch 2/4
6000/6000 [==============================] - 1s 157us/step - loss: 0.2607 - acc: 0.9220 - val_loss: 0.2345 - val_acc: 0.9293
Epoch 3/4
6000/6000 [==============================] - 1s 158us/step - loss: 0.1719 - acc: 0.9470 - val_loss: 0.2141 - val_acc: 0.9380
Epoch 4/4
6000/6000 [==============================] - 1s 144us/step - loss: 0.1221 - acc: 0.9627 - val_loss: 0.2050 - val_acc: 0.9385
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 260us/step - loss: 0.6955 - acc: 0.7897 - val_loss: 0.3049 - val_acc: 0.9106
Epoch 2/4
6000/6000 [==============================] - 1s 148us/step - loss: 0.2780 - acc: 0.9165 - val_loss: 0.2314 - val_acc: 0.9326
Epoch 3/4
6000/6000 [==============================] - 1s 137us/step - loss: 0.1756 - acc: 0.9475 - val_loss: 0.2065 - val_acc: 0.9383
Epoch 4/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.1253 - acc: 0.9600 - val_loss: 0.1887 - val_acc: 0.9430
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 252us/step - loss: 0.6963 - acc: 0.7867 - val_loss: 0.3166 - val_acc: 0.9044
Epoch 2/4
6000/6000 [==============================] - 1s 136us/step - loss: 0.2573 - acc: 0.9197 - val_loss: 0.2341 - val_acc: 0.9279
Epoch 3/4
6000/6000 [==============================] - 1s 141us/step - loss: 0.1682 - acc: 0.9490 - val_loss: 0.2029 - val_acc: 0.9377
Epoch 4/4
6000/6000 [==============================] - 1s 137us/step - loss: 0.1203 - acc: 0.9650 - val_loss: 0.1963 - val_acc: 0.9417
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 252us/step - loss: 0.6972 - acc: 0.7878 - val_loss: 0.3125 - val_acc: 0.9062
Epoch 2/4
6000/6000 [==============================] - 1s 139us/step - loss: 0.2833 - acc: 0.9133 - val_loss: 0.2621 - val_acc: 0.9193
Epoch 3/4
6000/6000 [==============================] - 1s 136us/step - loss: 0.1827 - acc: 0.9433 - val_loss: 0.2123 - val_acc: 0.9361
Epoch 4/4
6000/6000 [==============================] - 1s 146us/step - loss: 0.1268 - acc: 0.9618 - val_loss: 0.1865 - val_acc: 0.9446
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 271us/step - loss: 0.6998 - acc: 0.7883 - val_loss: 0.3024 - val_acc: 0.9136
Epoch 2/4
6000/6000 [==============================] - 1s 136us/step - loss: 0.2727 - acc: 0.9175 - val_loss: 0.2651 - val_acc: 0.9157
Epoch 3/4
6000/6000 [==============================] - 1s 139us/step - loss: 0.1825 - acc: 0.9458 - val_loss: 0.1966 - val_acc: 0.9392
Epoch 4/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1227 - acc: 0.9627 - val_loss: 0.1848 - val_acc: 0.9406
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 259us/step - loss: 0.6218 - acc: 0.8197 - val_loss: 0.3359 - val_acc: 0.8991
Epoch 2/4
6000/6000 [==============================] - 1s 139us/step - loss: 0.2128 - acc: 0.9352 - val_loss: 0.2693 - val_acc: 0.9173
Epoch 3/4
6000/6000 [==============================] - 1s 138us/step - loss: 0.1343 - acc: 0.9617 - val_loss: 0.2205 - val_acc: 0.9346
Epoch 4/4
6000/6000 [==============================] - 1s 139us/step - loss: 0.0955 - acc: 0.9723 - val_loss: 0.1976 - val_acc: 0.9412
10000/10000 [==============================] - 1s 105us/step
['9.154791186523438', '0.4281']
Grand Epoch: 3 / 3
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 307us/step - loss: 0.6467 - acc: 0.8052 - val_loss: 0.3125 - val_acc: 0.9063
Epoch 2/4
6000/6000 [==============================] - 1s 136us/step - loss: 0.2476 - acc: 0.9263 - val_loss: 0.2527 - val_acc: 0.9221
Epoch 3/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.1568 - acc: 0.9550 - val_loss: 0.2084 - val_acc: 0.9356
Epoch 4/4
6000/6000 [==============================] - 1s 143us/step - loss: 0.1032 - acc: 0.9688 - val_loss: 0.1883 - val_acc: 0.9435
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 295us/step - loss: 0.6800 - acc: 0.7963 - val_loss: 0.3025 - val_acc: 0.9121
Epoch 2/4
6000/6000 [==============================] - 1s 138us/step - loss: 0.2568 - acc: 0.9242 - val_loss: 0.2427 - val_acc: 0.9247
Epoch 3/4
6000/6000 [==============================] - 1s 137us/step - loss: 0.1919 - acc: 0.9443 - val_loss: 0.2182 - val_acc: 0.9341
Epoch 4/4
6000/6000 [==============================] - 1s 141us/step - loss: 0.1286 - acc: 0.9598 - val_loss: 0.1899 - val_acc: 0.9421
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 320us/step - loss: 0.7267 - acc: 0.7855 - val_loss: 0.2953 - val_acc: 0.9121
Epoch 2/4
6000/6000 [==============================] - 1s 147us/step - loss: 0.2753 - acc: 0.9178 - val_loss: 0.2539 - val_acc: 0.9239
Epoch 3/4
6000/6000 [==============================] - 1s 144us/step - loss: 0.1831 - acc: 0.9418 - val_loss: 0.1878 - val_acc: 0.9412
Epoch 4/4
6000/6000 [==============================] - 1s 145us/step - loss: 0.1227 - acc: 0.9660 - val_loss: 0.1739 - val_acc: 0.9490
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 309us/step - loss: 0.6707 - acc: 0.8013 - val_loss: 0.3277 - val_acc: 0.8999
Epoch 2/4
6000/6000 [==============================] - 1s 147us/step - loss: 0.2435 - acc: 0.9262 - val_loss: 0.2290 - val_acc: 0.9302
Epoch 3/4
6000/6000 [==============================] - 1s 159us/step - loss: 0.1582 - acc: 0.9552 - val_loss: 0.2052 - val_acc: 0.9355
Epoch 4/4
6000/6000 [==============================] - 1s 146us/step - loss: 0.1133 - acc: 0.9645 - val_loss: 0.1883 - val_acc: 0.9434
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 308us/step - loss: 0.6907 - acc: 0.7885 - val_loss: 0.3223 - val_acc: 0.9047
Epoch 2/4
6000/6000 [==============================] - 1s 138us/step - loss: 0.2645 - acc: 0.9195 - val_loss: 0.2641 - val_acc: 0.9201
Epoch 3/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.1730 - acc: 0.9483 - val_loss: 0.2132 - val_acc: 0.9361
Epoch 4/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.1179 - acc: 0.9627 - val_loss: 0.1982 - val_acc: 0.9426
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 309us/step - loss: 0.7054 - acc: 0.7808 - val_loss: 0.3112 - val_acc: 0.9048
Epoch 2/4
6000/6000 [==============================] - 1s 148us/step - loss: 0.2531 - acc: 0.9230 - val_loss: 0.2195 - val_acc: 0.9341
Epoch 3/4
6000/6000 [==============================] - 1s 141us/step - loss: 0.1570 - acc: 0.9533 - val_loss: 0.1943 - val_acc: 0.9404
Epoch 4/4
6000/6000 [==============================] - 1s 148us/step - loss: 0.1104 - acc: 0.9670 - val_loss: 0.1790 - val_acc: 0.9461
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 327us/step - loss: 0.6768 - acc: 0.7985 - val_loss: 0.3213 - val_acc: 0.9049
Epoch 2/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.2567 - acc: 0.9233 - val_loss: 0.2244 - val_acc: 0.9313
Epoch 3/4
6000/6000 [==============================] - 1s 141us/step - loss: 0.1753 - acc: 0.9467 - val_loss: 0.2128 - val_acc: 0.9362
Epoch 4/4
6000/6000 [==============================] - 1s 144us/step - loss: 0.1291 - acc: 0.9590 - val_loss: 0.1774 - val_acc: 0.9462
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 335us/step - loss: 0.6914 - acc: 0.7878 - val_loss: 0.3030 - val_acc: 0.9122
Epoch 2/4
6000/6000 [==============================] - 1s 141us/step - loss: 0.2625 - acc: 0.9198 - val_loss: 0.2306 - val_acc: 0.9312
Epoch 3/4
6000/6000 [==============================] - 1s 140us/step - loss: 0.1983 - acc: 0.9397 - val_loss: 0.2173 - val_acc: 0.9341
Epoch 4/4
6000/6000 [==============================] - 1s 138us/step - loss: 0.1263 - acc: 0.9605 - val_loss: 0.1868 - val_acc: 0.9465
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 347us/step - loss: 0.6863 - acc: 0.7965 - val_loss: 0.3077 - val_acc: 0.9074
Epoch 2/4
6000/6000 [==============================] - 1s 145us/step - loss: 0.2750 - acc: 0.9157 - val_loss: 0.2507 - val_acc: 0.9225
Epoch 3/4
6000/6000 [==============================] - 1s 153us/step - loss: 0.1730 - acc: 0.9463 - val_loss: 0.2050 - val_acc: 0.9363
Epoch 4/4
6000/6000 [==============================] - 1s 139us/step - loss: 0.1244 - acc: 0.9603 - val_loss: 0.1826 - val_acc: 0.9436
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 2s 335us/step - loss: 0.6068 - acc: 0.8175 - val_loss: 0.3066 - val_acc: 0.9094
Epoch 2/4
6000/6000 [==============================] - 1s 142us/step - loss: 0.2125 - acc: 0.9358 - val_loss: 0.2672 - val_acc: 0.9176
Epoch 3/4
6000/6000 [==============================] - 1s 142us/step - loss: 0.1423 - acc: 0.9582 - val_loss: 0.2203 - val_acc: 0.9332
Epoch 4/4
6000/6000 [==============================] - 1s 148us/step - loss: 0.0939 - acc: 0.9702 - val_loss: 0.2108 - val_acc: 0.9371
10000/10000 [==============================] - 1s 141us/step
['9.678184410095215', '0.3957']
60000/60000 [==============================] - 3s 54us/step
10000/10000 [==============================] - 1s 53us/step
Training accuracy with merged model: 0.38745
Test accuracy with merged model: 0.3957
Training accuracy with ensembling and consensus predictors: 0.957266666667
Test accuracy with ensembling and consensus predictors: 0.956

  asridhar in ~/Desktop/distributed_neural_network
±  |master S:5 ✗| → python distributed_model_training.py
dyld: warning, LC_RPATH $ORIGIN/../../_solib_darwin_x86_64/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow in /Library/Python/2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so being ignored in restricted program because it is a relative path
/Library/Python/2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 200us/step - loss: 0.6639 - acc: 0.8090 - val_loss: 0.3183 - val_acc: 0.9041
Epoch 2/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.2560 - acc: 0.9272 - val_loss: 0.2592 - val_acc: 0.9220
Epoch 3/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.1653 - acc: 0.9533 - val_loss: 0.2172 - val_acc: 0.9301
Epoch 4/4
6000/6000 [==============================] - 1s 130us/step - loss: 0.1084 - acc: 0.9687 - val_loss: 0.2015 - val_acc: 0.9393
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 179us/step - loss: 0.6821 - acc: 0.7968 - val_loss: 0.3483 - val_acc: 0.8971
Epoch 2/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.2509 - acc: 0.9285 - val_loss: 0.2551 - val_acc: 0.9220
Epoch 3/4
6000/6000 [==============================] - 1s 130us/step - loss: 0.1712 - acc: 0.9507 - val_loss: 0.2035 - val_acc: 0.9400
Epoch 4/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1112 - acc: 0.9668 - val_loss: 0.2128 - val_acc: 0.9362
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 179us/step - loss: 0.7350 - acc: 0.7785 - val_loss: 0.3041 - val_acc: 0.9098
Epoch 2/4
6000/6000 [==============================] - 1s 130us/step - loss: 0.2723 - acc: 0.9180 - val_loss: 0.2107 - val_acc: 0.9363
Epoch 3/4
6000/6000 [==============================] - 1s 130us/step - loss: 0.1735 - acc: 0.9448 - val_loss: 0.1832 - val_acc: 0.9428
Epoch 4/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.1186 - acc: 0.9660 - val_loss: 0.1632 - val_acc: 0.9495
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 188us/step - loss: 0.6833 - acc: 0.7958 - val_loss: 0.3441 - val_acc: 0.8948
Epoch 2/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.2536 - acc: 0.9270 - val_loss: 0.2363 - val_acc: 0.9302
Epoch 3/4
6000/6000 [==============================] - 1s 129us/step - loss: 0.1662 - acc: 0.9517 - val_loss: 0.1991 - val_acc: 0.9395
Epoch 4/4
6000/6000 [==============================] - 1s 122us/step - loss: 0.1208 - acc: 0.9628 - val_loss: 0.1853 - val_acc: 0.9427
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 180us/step - loss: 0.6966 - acc: 0.7900 - val_loss: 0.3016 - val_acc: 0.9098
Epoch 2/4
6000/6000 [==============================] - 1s 122us/step - loss: 0.2632 - acc: 0.9192 - val_loss: 0.2407 - val_acc: 0.9263
Epoch 3/4
6000/6000 [==============================] - 1s 123us/step - loss: 0.1642 - acc: 0.9532 - val_loss: 0.2348 - val_acc: 0.9295
Epoch 4/4
6000/6000 [==============================] - 1s 124us/step - loss: 0.1221 - acc: 0.9608 - val_loss: 0.1933 - val_acc: 0.9405
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 190us/step - loss: 0.7021 - acc: 0.7892 - val_loss: 0.3014 - val_acc: 0.9077
Epoch 2/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.2605 - acc: 0.9255 - val_loss: 0.2674 - val_acc: 0.9176
Epoch 3/4
6000/6000 [==============================] - 1s 143us/step - loss: 0.1702 - acc: 0.9502 - val_loss: 0.2023 - val_acc: 0.9383
Epoch 4/4
6000/6000 [==============================] - 1s 127us/step - loss: 0.1161 - acc: 0.9622 - val_loss: 0.1941 - val_acc: 0.9448
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 200us/step - loss: 0.6913 - acc: 0.7967 - val_loss: 0.3132 - val_acc: 0.9113
Epoch 2/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.2610 - acc: 0.9235 - val_loss: 0.2427 - val_acc: 0.9286
Epoch 3/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1724 - acc: 0.9492 - val_loss: 0.2006 - val_acc: 0.9390
Epoch 4/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1249 - acc: 0.9595 - val_loss: 0.1860 - val_acc: 0.9436
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 206us/step - loss: 0.6867 - acc: 0.7902 - val_loss: 0.3017 - val_acc: 0.9112
Epoch 2/4
6000/6000 [==============================] - 1s 135us/step - loss: 0.2705 - acc: 0.9192 - val_loss: 0.2389 - val_acc: 0.9293
Epoch 3/4
6000/6000 [==============================] - 1s 142us/step - loss: 0.1864 - acc: 0.9412 - val_loss: 0.2092 - val_acc: 0.9368
Epoch 4/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1286 - acc: 0.9630 - val_loss: 0.1860 - val_acc: 0.9464
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 208us/step - loss: 0.6939 - acc: 0.7880 - val_loss: 0.2954 - val_acc: 0.9120
Epoch 2/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.2633 - acc: 0.9212 - val_loss: 0.2381 - val_acc: 0.9275
Epoch 3/4
6000/6000 [==============================] - 1s 135us/step - loss: 0.1770 - acc: 0.9442 - val_loss: 0.2086 - val_acc: 0.9358
Epoch 4/4
6000/6000 [==============================] - 1s 131us/step - loss: 0.1264 - acc: 0.9608 - val_loss: 0.1848 - val_acc: 0.9423
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/4
6000/6000 [==============================] - 1s 210us/step - loss: 0.5987 - acc: 0.8305 - val_loss: 0.3271 - val_acc: 0.9042
Epoch 2/4
6000/6000 [==============================] - 1s 132us/step - loss: 0.2100 - acc: 0.9378 - val_loss: 0.2485 - val_acc: 0.9260
Epoch 3/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1386 - acc: 0.9568 - val_loss: 0.2247 - val_acc: 0.9328
Epoch 4/4
6000/6000 [==============================] - 1s 134us/step - loss: 0.1024 - acc: 0.9680 - val_loss: 0.2126 - val_acc: 0.9370
10000/10000 [==============================] - 1s 73us/step
['5.307760876083374', '0.6612']
60000/60000 [==============================] - 3s 43us/step
10000/10000 [==============================] - 0s 45us/step
Training accuracy with merged model: 0.6528666666666667
Test accuracy with merged model: 0.6612
Training accuracy with ensembling and consensus predictors: 0.956183333333
Test accuracy with ensembling and consensus predictors: 0.9555
