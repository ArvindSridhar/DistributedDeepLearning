Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 721us/step - loss: 1.6091 - acc: 0.5270 - val_loss: 0.9054 - val_acc: 0.7428
Epoch 2/2
1000/1000 [==============================] - 0s 277us/step - loss: 0.6157 - acc: 0.8120 - val_loss: 0.5721 - val_acc: 0.8105
Segment: seg1
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 669us/step - loss: 1.5971 - acc: 0.5420 - val_loss: 0.8396 - val_acc: 0.7995
Epoch 2/2
1000/1000 [==============================] - 0s 291us/step - loss: 0.5813 - acc: 0.8370 - val_loss: 0.4950 - val_acc: 0.8533
Segment: seg2
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 593us/step - loss: 1.5626 - acc: 0.5620 - val_loss: 0.8149 - val_acc: 0.7810
Epoch 2/2
1000/1000 [==============================] - 0s 330us/step - loss: 0.5260 - acc: 0.8560 - val_loss: 0.4999 - val_acc: 0.8360
Segment: seg3
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 633us/step - loss: 1.5877 - acc: 0.5330 - val_loss: 0.8014 - val_acc: 0.7973
Epoch 2/2
1000/1000 [==============================] - 0s 279us/step - loss: 0.5636 - acc: 0.8350 - val_loss: 0.5264 - val_acc: 0.8266
Segment: seg4
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 652us/step - loss: 1.6028 - acc: 0.5200 - val_loss: 0.8594 - val_acc: 0.7744
Epoch 2/2
1000/1000 [==============================] - 0s 283us/step - loss: 0.5883 - acc: 0.8350 - val_loss: 0.5330 - val_acc: 0.8422
Segment: seg5
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 669us/step - loss: 1.5946 - acc: 0.5440 - val_loss: 0.9389 - val_acc: 0.7217
Epoch 2/2
1000/1000 [==============================] - 0s 295us/step - loss: 0.5895 - acc: 0.8250 - val_loss: 0.5387 - val_acc: 0.8354
Segment: seg6
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 717us/step - loss: 1.5426 - acc: 0.5890 - val_loss: 0.8043 - val_acc: 0.7985
Epoch 2/2
1000/1000 [==============================] - 0s 287us/step - loss: 0.5048 - acc: 0.8640 - val_loss: 0.5647 - val_acc: 0.8320
Segment: seg7
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 728us/step - loss: 1.6396 - acc: 0.5280 - val_loss: 0.8455 - val_acc: 0.7839
Epoch 2/2
1000/1000 [==============================] - 0s 299us/step - loss: 0.6550 - acc: 0.8170 - val_loss: 0.4579 - val_acc: 0.8596
Segment: seg8
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 758us/step - loss: 1.6546 - acc: 0.5100 - val_loss: 0.8919 - val_acc: 0.7822
Epoch 2/2
1000/1000 [==============================] - 0s 314us/step - loss: 0.6947 - acc: 0.8020 - val_loss: 0.5357 - val_acc: 0.8340
Segment: seg9
Train on 1000 samples, validate on 10000 samples
Epoch 1/2
1000/1000 [==============================] - 1s 776us/step - loss: 1.4998 - acc: 0.5750 - val_loss: 0.8259 - val_acc: 0.7548
Epoch 2/2
1000/1000 [==============================] - 0s 295us/step - loss: 0.5333 - acc: 0.8500 - val_loss: 0.6173 - val_acc: 0.8067

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.61365
Test set prediction accuracy with aggregate model: 0.6156
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.86855
Test set prediction accuracy with consensus prediction ensembling: 0.8746
-------------------------------------------------------------------------------------------------
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(5000, 10, 10, 1)
Epoch 1/40
5000/5000 [==============================] - 1s 243us/step - loss: 1.2656 - acc: 0.6666
Epoch 2/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.6063 - acc: 0.8480
Epoch 3/40
5000/5000 [==============================] - 1s 136us/step - loss: 0.5561 - acc: 0.8544
Epoch 4/40
5000/5000 [==============================] - 1s 143us/step - loss: 0.5283 - acc: 0.8552
Epoch 5/40
5000/5000 [==============================] - 1s 138us/step - loss: 0.5155 - acc: 0.8606
Epoch 6/40
5000/5000 [==============================] - 1s 137us/step - loss: 0.5015 - acc: 0.8622
Epoch 7/40
5000/5000 [==============================] - 1s 143us/step - loss: 0.4997 - acc: 0.8620
Epoch 8/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.4914 - acc: 0.8652
Epoch 9/40
5000/5000 [==============================] - 1s 137us/step - loss: 0.4795 - acc: 0.8668
Epoch 10/40
5000/5000 [==============================] - 1s 143us/step - loss: 0.4661 - acc: 0.8662
Epoch 11/40
5000/5000 [==============================] - 1s 139us/step - loss: 0.4619 - acc: 0.8694
Epoch 12/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.4536 - acc: 0.8700
Epoch 13/40
5000/5000 [==============================] - 1s 136us/step - loss: 0.4471 - acc: 0.8704
Epoch 14/40
5000/5000 [==============================] - 1s 139us/step - loss: 0.4346 - acc: 0.8752
Epoch 15/40
5000/5000 [==============================] - 1s 137us/step - loss: 0.4261 - acc: 0.8754
Epoch 16/40
5000/5000 [==============================] - 1s 134us/step - loss: 0.4248 - acc: 0.8752
Epoch 17/40
5000/5000 [==============================] - 1s 142us/step - loss: 0.4074 - acc: 0.8836
Epoch 18/40
5000/5000 [==============================] - 1s 138us/step - loss: 0.4115 - acc: 0.8764
Epoch 19/40
5000/5000 [==============================] - 1s 135us/step - loss: 0.3992 - acc: 0.8796
Epoch 20/40
5000/5000 [==============================] - 1s 141us/step - loss: 0.3939 - acc: 0.8826
Epoch 21/40
5000/5000 [==============================] - 1s 139us/step - loss: 0.3789 - acc: 0.8848
Epoch 22/40
5000/5000 [==============================] - 1s 138us/step - loss: 0.3735 - acc: 0.8856
Epoch 23/40
5000/5000 [==============================] - 1s 135us/step - loss: 0.3736 - acc: 0.8886
Epoch 24/40
5000/5000 [==============================] - 1s 141us/step - loss: 0.3644 - acc: 0.8872
Epoch 25/40
5000/5000 [==============================] - 1s 139us/step - loss: 0.3604 - acc: 0.8884
Epoch 26/40
5000/5000 [==============================] - 1s 136us/step - loss: 0.3608 - acc: 0.8888
Epoch 27/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.3494 - acc: 0.8920
Epoch 28/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.3464 - acc: 0.8934
Epoch 29/40
5000/5000 [==============================] - 1s 138us/step - loss: 0.3377 - acc: 0.8996
Epoch 30/40
5000/5000 [==============================] - 1s 142us/step - loss: 0.3377 - acc: 0.8994
Epoch 31/40
5000/5000 [==============================] - 1s 142us/step - loss: 0.3217 - acc: 0.8992
Epoch 32/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.3238 - acc: 0.9012
Epoch 33/40
5000/5000 [==============================] - 1s 138us/step - loss: 0.3211 - acc: 0.9006
Epoch 34/40
5000/5000 [==============================] - 1s 142us/step - loss: 0.3090 - acc: 0.9064
Epoch 35/40
5000/5000 [==============================] - 1s 140us/step - loss: 0.3055 - acc: 0.9008
Epoch 36/40
5000/5000 [==============================] - 1s 137us/step - loss: 0.3040 - acc: 0.9080
Epoch 37/40
5000/5000 [==============================] - 1s 139us/step - loss: 0.2982 - acc: 0.9070
Epoch 38/40
5000/5000 [==============================] - 1s 139us/step - loss: 0.2924 - acc: 0.9066
Epoch 39/40
5000/5000 [==============================] - 1s 137us/step - loss: 0.2823 - acc: 0.9120
Epoch 40/40
5000/5000 [==============================] - 1s 144us/step - loss: 0.2804 - acc: 0.9108
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble training data: 0.932
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble test data: 0.9234
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
Training set prediction accuracy with neural boosted ensembling: 0.9034
Test set prediction accuracy with neural boosted ensembling: 0.9277




Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 65us/step - loss: 1.1895 - acc: 0.6812 - val_loss: 0.6277 - val_acc: 0.8473
Epoch 2/2
6000/6000 [==============================] - 0s 22us/step - loss: 0.4714 - acc: 0.8748 - val_loss: 0.4320 - val_acc: 0.8826
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 54us/step - loss: 1.2395 - acc: 0.6673 - val_loss: 0.6177 - val_acc: 0.8384
Epoch 2/2
6000/6000 [==============================] - 0s 23us/step - loss: 0.4805 - acc: 0.8762 - val_loss: 0.4238 - val_acc: 0.8864
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 58us/step - loss: 1.3525 - acc: 0.6205 - val_loss: 0.6965 - val_acc: 0.8212
Epoch 2/2
6000/6000 [==============================] - 0s 26us/step - loss: 0.5735 - acc: 0.8437 - val_loss: 0.4327 - val_acc: 0.8868
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 58us/step - loss: 1.2426 - acc: 0.6672 - val_loss: 0.6043 - val_acc: 0.8562
Epoch 2/2
6000/6000 [==============================] - 0s 24us/step - loss: 0.4708 - acc: 0.8828 - val_loss: 0.4194 - val_acc: 0.8904
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 60us/step - loss: 1.1338 - acc: 0.7143 - val_loss: 0.5744 - val_acc: 0.8585
Epoch 2/2
6000/6000 [==============================] - 0s 26us/step - loss: 0.4685 - acc: 0.8727 - val_loss: 0.4196 - val_acc: 0.8871
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 67us/step - loss: 1.3116 - acc: 0.6457 - val_loss: 0.6341 - val_acc: 0.8474
Epoch 2/2
6000/6000 [==============================] - 0s 27us/step - loss: 0.5185 - acc: 0.8662 - val_loss: 0.4119 - val_acc: 0.8942
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 69us/step - loss: 1.2575 - acc: 0.6693 - val_loss: 0.6178 - val_acc: 0.8516
Epoch 2/2
6000/6000 [==============================] - 0s 28us/step - loss: 0.5002 - acc: 0.8680 - val_loss: 0.4186 - val_acc: 0.8889
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 70us/step - loss: 1.2875 - acc: 0.6505 - val_loss: 0.6252 - val_acc: 0.8453
Epoch 2/2
6000/6000 [==============================] - 0s 23us/step - loss: 0.5135 - acc: 0.8658 - val_loss: 0.4160 - val_acc: 0.8893
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 74us/step - loss: 1.1476 - acc: 0.7055 - val_loss: 0.5788 - val_acc: 0.8495
Epoch 2/2
6000/6000 [==============================] - 0s 25us/step - loss: 0.4917 - acc: 0.8690 - val_loss: 0.4192 - val_acc: 0.8843
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 81us/step - loss: 1.1750 - acc: 0.7067 - val_loss: 0.5770 - val_acc: 0.8585
Epoch 2/2
6000/6000 [==============================] - 0s 25us/step - loss: 0.4047 - acc: 0.9010 - val_loss: 0.4063 - val_acc: 0.8892

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.4904833333333333
Test set prediction accuracy with aggregate model: 0.4905
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.892533333333
Test set prediction accuracy with consensus prediction ensembling: 0.8998
-------------------------------------------------------------------------------------------------
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(5000, 10, 10, 1)
Epoch 1/60
5000/5000 [==============================] - 1s 208us/step - loss: 1.2397 - acc: 0.6810
Epoch 2/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.5493 - acc: 0.8702
Epoch 3/60
5000/5000 [==============================] - 1s 123us/step - loss: 0.4987 - acc: 0.8734
Epoch 4/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.4855 - acc: 0.8754
Epoch 5/60
5000/5000 [==============================] - 1s 127us/step - loss: 0.4717 - acc: 0.8770
Epoch 6/60
5000/5000 [==============================] - 1s 127us/step - loss: 0.4547 - acc: 0.8776
Epoch 7/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.4467 - acc: 0.8788
Epoch 8/60
5000/5000 [==============================] - 1s 128us/step - loss: 0.4406 - acc: 0.8772
Epoch 9/60
5000/5000 [==============================] - 1s 125us/step - loss: 0.4277 - acc: 0.8824
Epoch 10/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.4231 - acc: 0.8806
Epoch 11/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.4186 - acc: 0.8824
Epoch 12/60
5000/5000 [==============================] - 1s 127us/step - loss: 0.4127 - acc: 0.8834
Epoch 13/60
5000/5000 [==============================] - 1s 140us/step - loss: 0.4107 - acc: 0.8856
Epoch 14/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.4071 - acc: 0.8858
Epoch 15/60
5000/5000 [==============================] - 1s 126us/step - loss: 0.3987 - acc: 0.8850
Epoch 16/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.3979 - acc: 0.8856
Epoch 17/60
5000/5000 [==============================] - 1s 124us/step - loss: 0.3900 - acc: 0.8868
Epoch 18/60
5000/5000 [==============================] - 1s 131us/step - loss: 0.3809 - acc: 0.8864
Epoch 19/60
5000/5000 [==============================] - 1s 125us/step - loss: 0.3760 - acc: 0.8916
Epoch 20/60
5000/5000 [==============================] - 1s 124us/step - loss: 0.3691 - acc: 0.8918
Epoch 21/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3732 - acc: 0.8900
Epoch 22/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.3668 - acc: 0.8912
Epoch 23/60
5000/5000 [==============================] - 1s 124us/step - loss: 0.3649 - acc: 0.8914
Epoch 24/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3509 - acc: 0.8950
Epoch 25/60
5000/5000 [==============================] - 1s 127us/step - loss: 0.3481 - acc: 0.8982
Epoch 26/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.3580 - acc: 0.8940
Epoch 27/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3404 - acc: 0.8952
Epoch 28/60
5000/5000 [==============================] - 1s 124us/step - loss: 0.3460 - acc: 0.8942
Epoch 29/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.3433 - acc: 0.8940
Epoch 30/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3387 - acc: 0.8954
Epoch 31/60
5000/5000 [==============================] - 1s 125us/step - loss: 0.3356 - acc: 0.8956
Epoch 32/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3318 - acc: 0.8956
Epoch 33/60
5000/5000 [==============================] - 1s 131us/step - loss: 0.3264 - acc: 0.8974
Epoch 34/60
5000/5000 [==============================] - 1s 125us/step - loss: 0.3201 - acc: 0.9008
Epoch 35/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.3171 - acc: 0.9006
Epoch 36/60
5000/5000 [==============================] - 1s 127us/step - loss: 0.3160 - acc: 0.9036
Epoch 37/60
5000/5000 [==============================] - 1s 126us/step - loss: 0.3224 - acc: 0.9014
Epoch 38/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3111 - acc: 0.9012
Epoch 39/60
5000/5000 [==============================] - 1s 124us/step - loss: 0.3091 - acc: 0.9060
Epoch 40/60
5000/5000 [==============================] - 1s 131us/step - loss: 0.2999 - acc: 0.9020
Epoch 41/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.3037 - acc: 0.9046
Epoch 42/60
5000/5000 [==============================] - 1s 125us/step - loss: 0.3032 - acc: 0.9020
Epoch 43/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2974 - acc: 0.9070
Epoch 44/60
5000/5000 [==============================] - 1s 139us/step - loss: 0.2964 - acc: 0.9084
Epoch 45/60
5000/5000 [==============================] - 1s 140us/step - loss: 0.2900 - acc: 0.9104
Epoch 46/60
5000/5000 [==============================] - 1s 128us/step - loss: 0.2946 - acc: 0.9078
Epoch 47/60
5000/5000 [==============================] - 1s 130us/step - loss: 0.2913 - acc: 0.9078
Epoch 48/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2861 - acc: 0.9088
Epoch 49/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2769 - acc: 0.9108
Epoch 50/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2898 - acc: 0.9110
Epoch 51/60
5000/5000 [==============================] - 1s 125us/step - loss: 0.2777 - acc: 0.9152
Epoch 52/60
5000/5000 [==============================] - 1s 132us/step - loss: 0.2712 - acc: 0.9136
Epoch 53/60
5000/5000 [==============================] - 1s 128us/step - loss: 0.2747 - acc: 0.9158
Epoch 54/60
5000/5000 [==============================] - 1s 126us/step - loss: 0.2653 - acc: 0.9156
Epoch 55/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2621 - acc: 0.9192
Epoch 56/60
5000/5000 [==============================] - 1s 128us/step - loss: 0.2642 - acc: 0.9172
Epoch 57/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2616 - acc: 0.9174
Epoch 58/60
5000/5000 [==============================] - 1s 129us/step - loss: 0.2579 - acc: 0.9168
Epoch 59/60
5000/5000 [==============================] - 1s 126us/step - loss: 0.2570 - acc: 0.9196
Epoch 60/60
5000/5000 [==============================] - 1s 134us/step - loss: 0.2541 - acc: 0.9172
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble training data: 0.9376
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble test data: 0.932
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
Training set prediction accuracy with neural boosted ensembling: 0.9083
Test set prediction accuracy with neural boosted ensembling: 0.9348
-------------------------------------------------------------------------------------------------

  asridhar in ~/Desktop/distributed_neural_network
±  |master U:1 ✗| → python distributed_nn_training_tech_talk_copy.py
dyld: warning, LC_RPATH $ORIGIN/../../_solib_darwin_x86_64/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow in /Users/asridhar/Library/Python/2.7/lib/python/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so being ignored in restricted program because it is a relative path
Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 60us/step - loss: 2.2234 - acc: 0.1683 - val_loss: 2.1739 - val_acc: 0.1925
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.1435 - acc: 0.1915 - val_loss: 2.1308 - val_acc: 0.1919
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 51us/step - loss: 2.2515 - acc: 0.1352 - val_loss: 2.1909 - val_acc: 0.1596
Epoch 2/2
6000/6000 [==============================] - 0s 19us/step - loss: 2.1517 - acc: 0.1638 - val_loss: 2.1301 - val_acc: 0.1779
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 50us/step - loss: 2.2621 - acc: 0.1103 - val_loss: 2.2155 - val_acc: 0.1673
Epoch 2/2
6000/6000 [==============================] - 0s 22us/step - loss: 2.1900 - acc: 0.1832 - val_loss: 2.1606 - val_acc: 0.1931
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 52us/step - loss: 2.2431 - acc: 0.1735 - val_loss: 2.1930 - val_acc: 0.2030
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.1626 - acc: 0.2035 - val_loss: 2.1338 - val_acc: 0.2047
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 57us/step - loss: 2.2229 - acc: 0.1743 - val_loss: 2.1720 - val_acc: 0.1902
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.1524 - acc: 0.1982 - val_loss: 2.1272 - val_acc: 0.1945
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 56us/step - loss: 2.2559 - acc: 0.0865 - val_loss: 2.2242 - val_acc: 0.0876
Epoch 2/2
6000/6000 [==============================] - 0s 17us/step - loss: 2.1954 - acc: 0.1783 - val_loss: 2.1725 - val_acc: 0.1964
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 61us/step - loss: 2.2453 - acc: 0.1732 - val_loss: 2.2000 - val_acc: 0.1969
Epoch 2/2
6000/6000 [==============================] - 0s 17us/step - loss: 2.1715 - acc: 0.1998 - val_loss: 2.1453 - val_acc: 0.2011
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 66us/step - loss: 2.2280 - acc: 0.1498 - val_loss: 2.1838 - val_acc: 0.1697
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.1642 - acc: 0.1767 - val_loss: 2.1353 - val_acc: 0.1716
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 66us/step - loss: 2.2381 - acc: 0.1707 - val_loss: 2.1750 - val_acc: 0.1855
Epoch 2/2
6000/6000 [==============================] - 0s 20us/step - loss: 2.1423 - acc: 0.1875 - val_loss: 2.1020 - val_acc: 0.1937
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 69us/step - loss: 2.2509 - acc: 0.1137 - val_loss: 2.2008 - val_acc: 0.1797
Epoch 2/2
6000/6000 [==============================] - 0s 17us/step - loss: 2.1623 - acc: 0.1875 - val_loss: 2.1385 - val_acc: 0.1918

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.11236666666666667
Test set prediction accuracy with aggregate model: 0.1135
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.306266666667
Test set prediction accuracy with consensus prediction ensembling: 0.3084
-------------------------------------------------------------------------------------------------
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(5000, 10, 10, 1)
Epoch 1/60
5000/5000 [==============================] - 1s 228us/step - loss: 2.1283 - acc: 0.2666
Epoch 2/60
5000/5000 [==============================] - 1s 144us/step - loss: 1.4845 - acc: 0.4802
Epoch 3/60
5000/5000 [==============================] - 1s 149us/step - loss: 1.2348 - acc: 0.5590
Epoch 4/60
5000/5000 [==============================] - 1s 149us/step - loss: 1.1254 - acc: 0.5958
Epoch 5/60
5000/5000 [==============================] - 1s 146us/step - loss: 1.0735 - acc: 0.6228
Epoch 6/60
5000/5000 [==============================] - 1s 144us/step - loss: 1.0474 - acc: 0.6200
Epoch 7/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.9967 - acc: 0.6378
Epoch 8/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.9626 - acc: 0.6572
Epoch 9/60
5000/5000 [==============================] - 1s 143us/step - loss: 0.9308 - acc: 0.6674
Epoch 10/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.9207 - acc: 0.6720
Epoch 11/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.9040 - acc: 0.6764
Epoch 12/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.8893 - acc: 0.6872
Epoch 13/60
5000/5000 [==============================] - 1s 142us/step - loss: 0.8687 - acc: 0.6928
Epoch 14/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.8549 - acc: 0.6982
Epoch 15/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.8476 - acc: 0.7038
Epoch 16/60
5000/5000 [==============================] - 1s 145us/step - loss: 0.8371 - acc: 0.7044
Epoch 17/60
5000/5000 [==============================] - 1s 143us/step - loss: 0.8172 - acc: 0.7120
Epoch 18/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.8184 - acc: 0.7178
Epoch 19/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.8047 - acc: 0.7148
Epoch 20/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.7960 - acc: 0.7178
Epoch 21/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.7885 - acc: 0.7234
Epoch 22/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.7750 - acc: 0.7280
Epoch 23/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.7695 - acc: 0.7262
Epoch 24/60
5000/5000 [==============================] - 1s 144us/step - loss: 0.7734 - acc: 0.7282
Epoch 25/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.7612 - acc: 0.7320
Epoch 26/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.7614 - acc: 0.7358
Epoch 27/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.7561 - acc: 0.7334
Epoch 28/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.7471 - acc: 0.7356
Epoch 29/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.7492 - acc: 0.7406
Epoch 30/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.7404 - acc: 0.7384
Epoch 31/60
5000/5000 [==============================] - 1s 141us/step - loss: 0.7384 - acc: 0.7428
Epoch 32/60
5000/5000 [==============================] - 1s 144us/step - loss: 0.7287 - acc: 0.7460
Epoch 33/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.7292 - acc: 0.7448
Epoch 34/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.7227 - acc: 0.7436
Epoch 35/60
5000/5000 [==============================] - 1s 143us/step - loss: 0.7109 - acc: 0.7516
Epoch 36/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.7145 - acc: 0.7502
Epoch 37/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.7076 - acc: 0.7514
Epoch 38/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.7001 - acc: 0.7532
Epoch 39/60
5000/5000 [==============================] - 1s 144us/step - loss: 0.7046 - acc: 0.7530
Epoch 40/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.6939 - acc: 0.7558
Epoch 41/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.6927 - acc: 0.7528
Epoch 42/60
5000/5000 [==============================] - 1s 155us/step - loss: 0.7006 - acc: 0.7552
Epoch 43/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.6873 - acc: 0.7592
Epoch 44/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.6875 - acc: 0.7632
Epoch 45/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.6783 - acc: 0.7552
Epoch 46/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.6752 - acc: 0.7598
Epoch 47/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6801 - acc: 0.7632
Epoch 48/60
5000/5000 [==============================] - 1s 167us/step - loss: 0.6805 - acc: 0.7586
Epoch 49/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.6823 - acc: 0.7606
Epoch 50/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.6754 - acc: 0.7606
Epoch 51/60
5000/5000 [==============================] - 1s 144us/step - loss: 0.6688 - acc: 0.7674
Epoch 52/60
5000/5000 [==============================] - 1s 156us/step - loss: 0.6723 - acc: 0.7600
Epoch 53/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.6685 - acc: 0.7622
Epoch 54/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6608 - acc: 0.7690
Epoch 55/60
5000/5000 [==============================] - 1s 152us/step - loss: 0.6609 - acc: 0.7674
Epoch 56/60
5000/5000 [==============================] - 1s 157us/step - loss: 0.6534 - acc: 0.7698
Epoch 57/60
5000/5000 [==============================] - 1s 152us/step - loss: 0.6532 - acc: 0.7732
Epoch 58/60
5000/5000 [==============================] - 1s 160us/step - loss: 0.6454 - acc: 0.7672
Epoch 59/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.6488 - acc: 0.7710
Epoch 60/60
5000/5000 [==============================] - 1s 142us/step - loss: 0.6395 - acc: 0.7738
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble training data: 0.7928
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble test data: 0.827
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
Training set prediction accuracy with neural boosted ensembling: 0.7909833333333334
Test set prediction accuracy with neural boosted ensembling: 0.8099
-------------------------------------------------------------------------------------------------

  asridhar in ~/Desktop/distributed_neural_network
±  |master U:1 ✗| → python distributed_nn_training_tech_talk_copy.py
dyld: warning, LC_RPATH $ORIGIN/../../_solib_darwin_x86_64/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow in /Users/asridhar/Library/Python/2.7/lib/python/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so being ignored in restricted program because it is a relative path
Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 71us/step - loss: 2.2558 - acc: 0.1542 - val_loss: 2.1960 - val_acc: 0.1762
Epoch 2/2
6000/6000 [==============================] - 0s 16us/step - loss: 2.1493 - acc: 0.1847 - val_loss: 2.1185 - val_acc: 0.1759
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 49us/step - loss: 2.2071 - acc: 0.1765 - val_loss: 2.1730 - val_acc: 0.1738
Epoch 2/2
6000/6000 [==============================] - 0s 17us/step - loss: 2.1336 - acc: 0.1888 - val_loss: 2.1291 - val_acc: 0.1757
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 63us/step - loss: 2.2562 - acc: 0.1300 - val_loss: 2.2029 - val_acc: 0.1547
Epoch 2/2
6000/6000 [==============================] - 0s 21us/step - loss: 2.1628 - acc: 0.1740 - val_loss: 2.1331 - val_acc: 0.1652
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 54us/step - loss: 2.2550 - acc: 0.1387 - val_loss: 2.2181 - val_acc: 0.1746
Epoch 2/2
6000/6000 [==============================] - 0s 17us/step - loss: 2.1893 - acc: 0.1758 - val_loss: 2.1704 - val_acc: 0.1746
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 60us/step - loss: 2.2695 - acc: 0.1672 - val_loss: 2.2361 - val_acc: 0.1821
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.2105 - acc: 0.1888 - val_loss: 2.1919 - val_acc: 0.1868
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 58us/step - loss: 2.2183 - acc: 0.1545 - val_loss: 2.1648 - val_acc: 0.1758
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.1452 - acc: 0.1863 - val_loss: 2.1109 - val_acc: 0.2080
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 61us/step - loss: 2.2962 - acc: 0.1060 - val_loss: 2.2501 - val_acc: 0.1498
Epoch 2/2
6000/6000 [==============================] - 0s 16us/step - loss: 2.1957 - acc: 0.1808 - val_loss: 2.1614 - val_acc: 0.1976
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 67us/step - loss: 2.2621 - acc: 0.1360 - val_loss: 2.2148 - val_acc: 0.1906
Epoch 2/2
6000/6000 [==============================] - 0s 17us/step - loss: 2.1897 - acc: 0.1827 - val_loss: 2.1460 - val_acc: 0.1871
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 69us/step - loss: 2.2551 - acc: 0.1382 - val_loss: 2.2105 - val_acc: 0.1841
Epoch 2/2
6000/6000 [==============================] - 0s 21us/step - loss: 2.1754 - acc: 0.1787 - val_loss: 2.1552 - val_acc: 0.1888
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/2
6000/6000 [==============================] - 0s 73us/step - loss: 2.2184 - acc: 0.1893 - val_loss: 2.1797 - val_acc: 0.1994
Epoch 2/2
6000/6000 [==============================] - 0s 18us/step - loss: 2.1306 - acc: 0.2060 - val_loss: 2.1278 - val_acc: 0.2052

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.17738333333333334
Test set prediction accuracy with aggregate model: 0.1745
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.299066666667
Test set prediction accuracy with consensus prediction ensembling: 0.3019
-------------------------------------------------------------------------------------------------
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(5000, 10, 10, 1)
Epoch 1/60
5000/5000 [==============================] - 1s 228us/step - loss: 2.1457 - acc: 0.2502
Epoch 2/60
5000/5000 [==============================] - 1s 150us/step - loss: 1.5179 - acc: 0.5124
Epoch 3/60
5000/5000 [==============================] - 1s 147us/step - loss: 1.1337 - acc: 0.6394
Epoch 4/60
5000/5000 [==============================] - 1s 152us/step - loss: 0.9896 - acc: 0.6846
Epoch 5/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.9066 - acc: 0.7094
Epoch 6/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.8691 - acc: 0.7166
Epoch 7/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.8318 - acc: 0.7344
Epoch 8/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.8085 - acc: 0.7380
Epoch 9/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.7782 - acc: 0.7452
Epoch 10/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.7667 - acc: 0.7484
Epoch 11/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.7492 - acc: 0.7608
Epoch 12/60
5000/5000 [==============================] - 1s 152us/step - loss: 0.7426 - acc: 0.7580
Epoch 13/60
5000/5000 [==============================] - 1s 158us/step - loss: 0.7289 - acc: 0.7642
Epoch 14/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.7174 - acc: 0.7666
Epoch 15/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.7114 - acc: 0.7680
Epoch 16/60
5000/5000 [==============================] - 1s 154us/step - loss: 0.6975 - acc: 0.7766
Epoch 17/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.6901 - acc: 0.7750
Epoch 18/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.6844 - acc: 0.7802
Epoch 19/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.6785 - acc: 0.7768
Epoch 20/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6659 - acc: 0.7824
Epoch 21/60
5000/5000 [==============================] - 1s 155us/step - loss: 0.6791 - acc: 0.7790
Epoch 22/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6687 - acc: 0.7812
Epoch 23/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6626 - acc: 0.7862
Epoch 24/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.6644 - acc: 0.7862
Epoch 25/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.6500 - acc: 0.7846
Epoch 26/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.6496 - acc: 0.7874
Epoch 27/60
5000/5000 [==============================] - 1s 145us/step - loss: 0.6467 - acc: 0.7892
Epoch 28/60
5000/5000 [==============================] - 1s 152us/step - loss: 0.6425 - acc: 0.7888
Epoch 29/60
5000/5000 [==============================] - 1s 157us/step - loss: 0.6168 - acc: 0.7972
Epoch 30/60
5000/5000 [==============================] - 1s 161us/step - loss: 0.6336 - acc: 0.7936
Epoch 31/60
5000/5000 [==============================] - 1s 156us/step - loss: 0.6170 - acc: 0.7952
Epoch 32/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.6253 - acc: 0.7942
Epoch 33/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6179 - acc: 0.7964
Epoch 34/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6088 - acc: 0.8006
Epoch 35/60
5000/5000 [==============================] - 1s 153us/step - loss: 0.6141 - acc: 0.7982
Epoch 36/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.6064 - acc: 0.7996
Epoch 37/60
5000/5000 [==============================] - 1s 161us/step - loss: 0.6039 - acc: 0.7992
Epoch 38/60
5000/5000 [==============================] - 1s 157us/step - loss: 0.6080 - acc: 0.7996
Epoch 39/60
5000/5000 [==============================] - 1s 156us/step - loss: 0.6002 - acc: 0.8006
Epoch 40/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.5960 - acc: 0.8034
Epoch 41/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.5951 - acc: 0.8008
Epoch 42/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.5877 - acc: 0.8034
Epoch 43/60
5000/5000 [==============================] - 1s 155us/step - loss: 0.5826 - acc: 0.8064
Epoch 44/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.5857 - acc: 0.8060
Epoch 45/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.5847 - acc: 0.8040
Epoch 46/60
5000/5000 [==============================] - 1s 159us/step - loss: 0.5812 - acc: 0.8112
Epoch 47/60
5000/5000 [==============================] - 1s 151us/step - loss: 0.5832 - acc: 0.8076
Epoch 48/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.5754 - acc: 0.8102
Epoch 49/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.5771 - acc: 0.8066
Epoch 50/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.5682 - acc: 0.8092
Epoch 51/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.5679 - acc: 0.8082
Epoch 52/60
5000/5000 [==============================] - 1s 150us/step - loss: 0.5720 - acc: 0.8078
Epoch 53/60
5000/5000 [==============================] - 1s 143us/step - loss: 0.5580 - acc: 0.8086
Epoch 54/60
5000/5000 [==============================] - 1s 146us/step - loss: 0.5680 - acc: 0.8138
Epoch 55/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.5620 - acc: 0.8122
Epoch 56/60
5000/5000 [==============================] - 1s 142us/step - loss: 0.5725 - acc: 0.8116
Epoch 57/60
5000/5000 [==============================] - 1s 149us/step - loss: 0.5510 - acc: 0.8156
Epoch 58/60
5000/5000 [==============================] - 1s 147us/step - loss: 0.5574 - acc: 0.8168
Epoch 59/60
5000/5000 [==============================] - 1s 148us/step - loss: 0.5543 - acc: 0.8124
Epoch 60/60
5000/5000 [==============================] - 1s 143us/step - loss: 0.5554 - acc: 0.8204
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble training data: 0.8342
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
(10, 5000)
Neural ensemble model accuracy on ensemble test data: 0.8524
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 60000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
(10, 10000)
Training set prediction accuracy with neural boosted ensembling: 0.8244166666666667
Test set prediction accuracy with neural boosted ensembling: 0.8433
-------------------------------------------------------------------------------------------------


IT FINALLY WORKS!



Side-by-side with neural ensembling:

Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 220us/step - loss: 0.6711 - acc: 0.7963 - val_loss: 0.2943 - val_acc: 0.9106
Epoch 2/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.2419 - acc: 0.9308 - val_loss: 0.2542 - val_acc: 0.9209
Epoch 3/3
6000/6000 [==============================] - 1s 141us/step - loss: 0.1562 - acc: 0.9548 - val_loss: 0.2277 - val_acc: 0.9294
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 191us/step - loss: 0.6791 - acc: 0.7940 - val_loss: 0.3038 - val_acc: 0.9146
Epoch 2/3
6000/6000 [==============================] - 1s 145us/step - loss: 0.2635 - acc: 0.9213 - val_loss: 0.2457 - val_acc: 0.9270
Epoch 3/3
6000/6000 [==============================] - 1s 142us/step - loss: 0.1763 - acc: 0.9495 - val_loss: 0.2036 - val_acc: 0.9383
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 202us/step - loss: 0.7207 - acc: 0.7850 - val_loss: 0.3070 - val_acc: 0.9108
Epoch 2/3
6000/6000 [==============================] - 1s 144us/step - loss: 0.2866 - acc: 0.9143 - val_loss: 0.2229 - val_acc: 0.9329
Epoch 3/3
6000/6000 [==============================] - 1s 142us/step - loss: 0.1782 - acc: 0.9467 - val_loss: 0.1793 - val_acc: 0.9447
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 190us/step - loss: 0.6619 - acc: 0.8010 - val_loss: 0.3065 - val_acc: 0.9101
Epoch 2/3
6000/6000 [==============================] - 1s 129us/step - loss: 0.2345 - acc: 0.9343 - val_loss: 0.2540 - val_acc: 0.9197
Epoch 3/3
6000/6000 [==============================] - 1s 128us/step - loss: 0.1648 - acc: 0.9490 - val_loss: 0.2165 - val_acc: 0.9327
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 210us/step - loss: 0.6794 - acc: 0.7987 - val_loss: 0.3330 - val_acc: 0.9024
Epoch 2/3
6000/6000 [==============================] - 1s 132us/step - loss: 0.2604 - acc: 0.9195 - val_loss: 0.2492 - val_acc: 0.9234
Epoch 3/3
6000/6000 [==============================] - 1s 160us/step - loss: 0.1725 - acc: 0.9492 - val_loss: 0.2281 - val_acc: 0.9314
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 215us/step - loss: 0.7058 - acc: 0.7913 - val_loss: 0.2865 - val_acc: 0.9183
Epoch 2/3
6000/6000 [==============================] - 1s 127us/step - loss: 0.2587 - acc: 0.9237 - val_loss: 0.2242 - val_acc: 0.9323
Epoch 3/3
6000/6000 [==============================] - 1s 148us/step - loss: 0.1749 - acc: 0.9475 - val_loss: 0.2324 - val_acc: 0.9309
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 235us/step - loss: 0.7020 - acc: 0.7845 - val_loss: 0.3061 - val_acc: 0.9112
Epoch 2/3
6000/6000 [==============================] - 1s 135us/step - loss: 0.2678 - acc: 0.9207 - val_loss: 0.2462 - val_acc: 0.9250
Epoch 3/3
6000/6000 [==============================] - 1s 139us/step - loss: 0.1823 - acc: 0.9418 - val_loss: 0.2129 - val_acc: 0.9353
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 221us/step - loss: 0.6813 - acc: 0.7900 - val_loss: 0.3267 - val_acc: 0.9019
Epoch 2/3
6000/6000 [==============================] - 1s 140us/step - loss: 0.2644 - acc: 0.9205 - val_loss: 0.2355 - val_acc: 0.9298
Epoch 3/3
6000/6000 [==============================] - 1s 141us/step - loss: 0.1825 - acc: 0.9452 - val_loss: 0.2284 - val_acc: 0.9292
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 238us/step - loss: 0.6984 - acc: 0.7917 - val_loss: 0.2925 - val_acc: 0.9127
Epoch 2/3
6000/6000 [==============================] - 1s 140us/step - loss: 0.2734 - acc: 0.9167 - val_loss: 0.2353 - val_acc: 0.9282
Epoch 3/3
6000/6000 [==============================] - 1s 138us/step - loss: 0.1799 - acc: 0.9447 - val_loss: 0.1972 - val_acc: 0.9382
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 239us/step - loss: 0.6013 - acc: 0.8215 - val_loss: 0.3149 - val_acc: 0.9103
Epoch 2/3
6000/6000 [==============================] - 1s 144us/step - loss: 0.2191 - acc: 0.9352 - val_loss: 0.2542 - val_acc: 0.9221
Epoch 3/3
6000/6000 [==============================] - 1s 153us/step - loss: 0.1353 - acc: 0.9582 - val_loss: 0.2235 - val_acc: 0.9338

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.48096666666666665
Test set prediction accuracy with aggregate model: 0.4858
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.950916666667
Test set prediction accuracy with consensus prediction ensembling: 0.9498
-------------------------------------------------------------------------------------------------
Neural ensemble model accuracy on ensemble training data: 0.9684
Neural ensemble model accuracy on ensemble test data: 0.947
Training set prediction accuracy with neural boosted ensembling: 0.9271833333333334
Test set prediction accuracy with neural boosted ensembling: 0.9577
-------------------------------------------------------------------------------------------------
Convolutional ensemble model accuracy on ensemble training data: 0.9856
Convolutional ensemble model accuracy on ensemble test data: 0.965
Training set prediction accuracy with convolutional boosted ensembling: 0.9501
Test set prediction accuracy with convolutional boosted ensembling: 0.9753
-------------------------------------------------------------------------------------------------

Take 2, 40 epochs for CNN instead of 60:

Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 202us/step - loss: 0.6615 - acc: 0.8122 - val_loss: 0.3198 - val_acc: 0.9040
Epoch 2/3
6000/6000 [==============================] - 1s 126us/step - loss: 0.2438 - acc: 0.9290 - val_loss: 0.2416 - val_acc: 0.9265
Epoch 3/3
6000/6000 [==============================] - 1s 127us/step - loss: 0.1585 - acc: 0.9502 - val_loss: 0.1939 - val_acc: 0.9397
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 178us/step - loss: 0.6727 - acc: 0.7940 - val_loss: 0.3124 - val_acc: 0.9050
Epoch 2/3
6000/6000 [==============================] - 1s 151us/step - loss: 0.2691 - acc: 0.9200 - val_loss: 0.2747 - val_acc: 0.9141
Epoch 3/3
6000/6000 [==============================] - 1s 158us/step - loss: 0.1877 - acc: 0.9423 - val_loss: 0.2105 - val_acc: 0.9349
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 226us/step - loss: 0.7158 - acc: 0.7808 - val_loss: 0.2866 - val_acc: 0.9194
Epoch 2/3
6000/6000 [==============================] - 1s 155us/step - loss: 0.2727 - acc: 0.9187 - val_loss: 0.2464 - val_acc: 0.9252
Epoch 3/3
6000/6000 [==============================] - 1s 153us/step - loss: 0.1709 - acc: 0.9482 - val_loss: 0.1997 - val_acc: 0.9391
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 185us/step - loss: 0.6656 - acc: 0.7990 - val_loss: 0.3016 - val_acc: 0.9118
Epoch 2/3
6000/6000 [==============================] - 1s 130us/step - loss: 0.2573 - acc: 0.9225 - val_loss: 0.2290 - val_acc: 0.9328
Epoch 3/3
6000/6000 [==============================] - 1s 127us/step - loss: 0.1625 - acc: 0.9538 - val_loss: 0.2012 - val_acc: 0.9410
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 190us/step - loss: 0.6855 - acc: 0.7978 - val_loss: 0.3391 - val_acc: 0.8970
Epoch 2/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.2583 - acc: 0.9213 - val_loss: 0.2310 - val_acc: 0.9296
Epoch 3/3
6000/6000 [==============================] - 1s 134us/step - loss: 0.1690 - acc: 0.9518 - val_loss: 0.2102 - val_acc: 0.9355
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 200us/step - loss: 0.6912 - acc: 0.7897 - val_loss: 0.2917 - val_acc: 0.9137
Epoch 2/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.2532 - acc: 0.9240 - val_loss: 0.2303 - val_acc: 0.9311
Epoch 3/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.1720 - acc: 0.9482 - val_loss: 0.1978 - val_acc: 0.9400
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 200us/step - loss: 0.6887 - acc: 0.7918 - val_loss: 0.3196 - val_acc: 0.9092
Epoch 2/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.2679 - acc: 0.9208 - val_loss: 0.2429 - val_acc: 0.9271
Epoch 3/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.2001 - acc: 0.9412 - val_loss: 0.2121 - val_acc: 0.9351
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 202us/step - loss: 0.6975 - acc: 0.7833 - val_loss: 0.3116 - val_acc: 0.9042
Epoch 2/3
6000/6000 [==============================] - 1s 134us/step - loss: 0.2704 - acc: 0.9185 - val_loss: 0.2294 - val_acc: 0.9310
Epoch 3/3
6000/6000 [==============================] - 1s 133us/step - loss: 0.1783 - acc: 0.9475 - val_loss: 0.1969 - val_acc: 0.9405
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 208us/step - loss: 0.7001 - acc: 0.7833 - val_loss: 0.3206 - val_acc: 0.9033
Epoch 2/3
6000/6000 [==============================] - 1s 134us/step - loss: 0.2681 - acc: 0.9193 - val_loss: 0.2647 - val_acc: 0.9163
Epoch 3/3
6000/6000 [==============================] - 1s 132us/step - loss: 0.1730 - acc: 0.9477 - val_loss: 0.1974 - val_acc: 0.9385
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 217us/step - loss: 0.6107 - acc: 0.8185 - val_loss: 0.3291 - val_acc: 0.9055
Epoch 2/3
6000/6000 [==============================] - 1s 133us/step - loss: 0.2125 - acc: 0.9378 - val_loss: 0.2552 - val_acc: 0.9240
Epoch 3/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.1452 - acc: 0.9540 - val_loss: 0.2213 - val_acc: 0.9353

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.7036166666666667
Test set prediction accuracy with aggregate model: 0.6984
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.9514
Test set prediction accuracy with consensus prediction ensembling: 0.9507
-------------------------------------------------------------------------------------------------
Neural ensemble model accuracy on ensemble training data: 0.969
Neural ensemble model accuracy on ensemble test data: 0.9496
Training set prediction accuracy with neural boosted ensembling: 0.92665
Test set prediction accuracy with neural boosted ensembling: 0.9593
-------------------------------------------------------------------------------------------------
Convolutional ensemble model accuracy on ensemble training data: 0.9724
Convolutional ensemble model accuracy on ensemble test data: 0.9634
Training set prediction accuracy with convolutional boosted ensembling: 0.9522
Test set prediction accuracy with convolutional boosted ensembling: 0.9679
-------------------------------------------------------------------------------------------------

Take 3, still 40 epochs:

Using TensorFlow backend.
Grand Epoch: 1 / 1
Segment: seg0
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 204us/step - loss: 0.6484 - acc: 0.8102 - val_loss: 0.3670 - val_acc: 0.8862
Epoch 2/3
6000/6000 [==============================] - 1s 134us/step - loss: 0.2471 - acc: 0.9258 - val_loss: 0.2494 - val_acc: 0.9201
Epoch 3/3
6000/6000 [==============================] - 1s 130us/step - loss: 0.1606 - acc: 0.9520 - val_loss: 0.2273 - val_acc: 0.9288
Segment: seg1
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 179us/step - loss: 0.6921 - acc: 0.7923 - val_loss: 0.3347 - val_acc: 0.8977
Epoch 2/3
6000/6000 [==============================] - 1s 134us/step - loss: 0.2665 - acc: 0.9247 - val_loss: 0.2459 - val_acc: 0.9292
Epoch 3/3
6000/6000 [==============================] - 1s 159us/step - loss: 0.1744 - acc: 0.9483 - val_loss: 0.2151 - val_acc: 0.9331
Segment: seg2
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 188us/step - loss: 0.7345 - acc: 0.7785 - val_loss: 0.2934 - val_acc: 0.9150
Epoch 2/3
6000/6000 [==============================] - 1s 143us/step - loss: 0.2745 - acc: 0.9165 - val_loss: 0.2221 - val_acc: 0.9326
Epoch 3/3
6000/6000 [==============================] - 1s 138us/step - loss: 0.1747 - acc: 0.9468 - val_loss: 0.1988 - val_acc: 0.9390
Segment: seg3
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 199us/step - loss: 0.6665 - acc: 0.8028 - val_loss: 0.3160 - val_acc: 0.9059
Epoch 2/3
6000/6000 [==============================] - 1s 130us/step - loss: 0.2439 - acc: 0.9280 - val_loss: 0.2495 - val_acc: 0.9268
Epoch 3/3
6000/6000 [==============================] - 1s 133us/step - loss: 0.1602 - acc: 0.9502 - val_loss: 0.1936 - val_acc: 0.9418
Segment: seg4
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 196us/step - loss: 0.6922 - acc: 0.7912 - val_loss: 0.3193 - val_acc: 0.9028
Epoch 2/3
6000/6000 [==============================] - 1s 133us/step - loss: 0.2613 - acc: 0.9207 - val_loss: 0.2347 - val_acc: 0.9279
Epoch 3/3
6000/6000 [==============================] - 1s 135us/step - loss: 0.1822 - acc: 0.9473 - val_loss: 0.2094 - val_acc: 0.9387
Segment: seg5
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 195us/step - loss: 0.7170 - acc: 0.7797 - val_loss: 0.3101 - val_acc: 0.9114
Epoch 2/3
6000/6000 [==============================] - 1s 125us/step - loss: 0.2650 - acc: 0.9202 - val_loss: 0.2353 - val_acc: 0.9289
Epoch 3/3
6000/6000 [==============================] - 1s 128us/step - loss: 0.1752 - acc: 0.9440 - val_loss: 0.1984 - val_acc: 0.9423
Segment: seg6
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 192us/step - loss: 0.6828 - acc: 0.7965 - val_loss: 0.2963 - val_acc: 0.9129
Epoch 2/3
6000/6000 [==============================] - 1s 129us/step - loss: 0.2697 - acc: 0.9187 - val_loss: 0.2485 - val_acc: 0.9244
Epoch 3/3
6000/6000 [==============================] - 1s 146us/step - loss: 0.1814 - acc: 0.9427 - val_loss: 0.1977 - val_acc: 0.9406
Segment: seg7
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 219us/step - loss: 0.6979 - acc: 0.7822 - val_loss: 0.3094 - val_acc: 0.9070
Epoch 2/3
6000/6000 [==============================] - 1s 130us/step - loss: 0.2822 - acc: 0.9120 - val_loss: 0.2387 - val_acc: 0.9300
Epoch 3/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.1826 - acc: 0.9437 - val_loss: 0.2111 - val_acc: 0.9379
Segment: seg8
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 206us/step - loss: 0.7022 - acc: 0.7902 - val_loss: 0.3278 - val_acc: 0.8972
Epoch 2/3
6000/6000 [==============================] - 1s 129us/step - loss: 0.2694 - acc: 0.9170 - val_loss: 0.2439 - val_acc: 0.9234
Epoch 3/3
6000/6000 [==============================] - 1s 131us/step - loss: 0.1732 - acc: 0.9463 - val_loss: 0.2186 - val_acc: 0.9337
Segment: seg9
Train on 6000 samples, validate on 10000 samples
Epoch 1/3
6000/6000 [==============================] - 1s 210us/step - loss: 0.5940 - acc: 0.8262 - val_loss: 0.3137 - val_acc: 0.9078
Epoch 2/3
6000/6000 [==============================] - 1s 133us/step - loss: 0.2124 - acc: 0.9328 - val_loss: 0.2841 - val_acc: 0.9131
Epoch 3/3
6000/6000 [==============================] - 1s 132us/step - loss: 0.1410 - acc: 0.9553 - val_loss: 0.2152 - val_acc: 0.9362

-------------------------------------------------------------------------------------------------
Training set prediction accuracy with aggregate model: 0.37466666666666665
Test set prediction accuracy with aggregate model: 0.3744
-------------------------------------------------------------------------------------------------
Training set prediction accuracy with consensus prediction ensembling: 0.951333333333
Test set prediction accuracy with consensus prediction ensembling: 0.9516
-------------------------------------------------------------------------------------------------
Neural ensemble model accuracy on ensemble training data: 0.9646
Neural ensemble model accuracy on ensemble test data: 0.946
Training set prediction accuracy with neural boosted ensembling: 0.9261
Test set prediction accuracy with neural boosted ensembling: 0.9553
-------------------------------------------------------------------------------------------------
Convolutional ensemble model accuracy on ensemble training data: 0.9678
Convolutional ensemble model accuracy on ensemble test data: 0.9632
Training set prediction accuracy with convolutional boosted ensembling: 0.9520333333333333
Test set prediction accuracy with convolutional boosted ensembling: 0.9655
-------------------------------------------------------------------------------------------------

Timing: 25 seconds for consensus, 58 seconds for neural, 54 seconds for convolutional
